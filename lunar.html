<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>양력 → 음력 변환기</title>
</head>
<body>
  <div style="max-width: 400px; margin: 30px auto; padding: 20px; border: 1px solid #ccc; font-family: sans-serif;">
    <h3>양력 → 음력 변환기</h3>
    <input type="date" id="solarInput" style="width: 100%; padding: 6px;" />
    <button onclick="convertToLunar()" style="margin-top: 10px; width: 100%; padding: 8px;">변환</button>
    <p id="result" style="margin-top: 15px; font-weight: bold;"></p>
  </div>

  <script>
    async function convertToLunar() {
      const solarDate = document.getElementById("solarInput").value;
      if (!solarDate) {
        document.getElementById("result").innerText = "날짜를 선택하세요.";
        return;
      }

      const [y, m, d] = solarDate.split("-");
      const apiUrl = `https://astro.kasi.re.kr/openapi/service/Life/SpcConv?solYear=${y}&solMonth=${m}&solDay=${d}&serviceKey=Wbkp%2FAlqvdi4rZl16gzdorIlWA89mFN6x79yc8JoTmHDkGz55az5k9VofuYNLeRz%2BWBg89%2F96R5RNrZuin0i1w%3D%3D&_type=json`;

      try {
        const res = await fetch(apiUrl);
        const data = await res.json();
        if (data.response.body.items.item) {
          const lunar = data.response.body.items.item;
          const lunarDate = \`\${lunar.lunYear}-\${lunar.lunMonth.padStart(2, '0')}-\${lunar.lunDay.padStart(2, '0')}\`;
          const isLeap = lunar.leapMonth === "1" ? " (윤달)" : "";
          document.getElementById("result").innerText = \`음력: \${lunarDate}\${isLeap}\`;
        } else {
          document.getElementById("result").innerText = "결과를 불러올 수 없습니다.";
        }
      } catch (e) {
        document.getElementById("result").innerText = "API 오류 발생";
      }
    }
  </script>
</body>
</html>